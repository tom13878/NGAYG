---
title: "Decomposing the maize yield gap in Nigeria"
author: "Michiel van Dijk (Wageningen Economic Research and International Institute for Advanced Systems Analysis), Tom Morley (Wageningen Economic Research) and Zuzana Smeets-Kristkova (Wageningen Economic Research)"
date: "`r format(Sys.time(), '%B %d, %Y')`"
output: 
  word_document:
    reference_docx: ../Common//word_styles_01.docx
bibliography: ../common/NGAYG.bib
---

```{r setup, include=FALSE}
library(rprojroot)
root <- find_root(is_rstudio_project)

library(knitr)
knitr::opts_chunk$set(
  fig.width=12, fig.height=8,
  dpi = 300,
  echo=FALSE, warning=FALSE, message=FALSE,
  fig.path = file.path(root,"FigTabMap/out-"),
  dev = "CairoPNG",
  dev.args = list(CairoPNG = list(bg = "transparent"))
  )

library(pander)
panderOptions('table.alignment.default', function(df)
    ifelse(sapply(df, is.numeric), 'right', 'left'))
panderOptions('table.split.table', Inf)
panderOptions('digits', 2)
panderOptions('round', 2)
panderOptions('big.mark', ",")
panderOptions('keep.trailing.zeros', TRUE)

source(file.path(root, "Code/NGA_fig.R"))
source(file.path(root, "Code/NGA_tab.R"))
source(file.path(root, "Code/NGA_map.R"))
```

__Abstract__
This paper adopts the framework developed by @VanDijk2016 to decompose the maize yield gap in Nigeria, combining crop simulation models and household survey data. The decomposition points out that the technology yield gap makes up the largest share of the total yield gap, followed by technical efficiency, feasible and economic yield gaps. With one exception the findings are similar across climate zones in Nigeria, suggesting that national factors play an important role in explaining the yield gap. The framework is also used to illustrate several inconsistencies with the definition and measurement of yield benchmarks that are frequently used in the yield gap literature. It is shown that highest farmers' yield can refer to both economic and technical benchmark levels. Finally, it is found that an alternative definition of economic yield that is grounded in mainstream economic theory results in similar values to the 70%-85% of potential yield that is used as a rule-of-thumb at present.       

__Acknowledgements__.
We are grateful to the following persons for input and comments: Martin van Ittersum, Pytrik Reidsma, Lenny van Bussel and Joao Vasco Silva. We would also like to thank Lenis Saweda Liverpool-Tasie for assistance with the data and the World Bank for making available an additional GPS dataset. This work was supported by the International Maize and Wheat Improvement Center (CIMMYT) through the CGIAR research program on MAIZE and Wageningen UR.


# Introduction
Yield gap is a powerful concept to illustrate the possibilities to increase future crop yield and to investigate why actual yield is lower than the biophysical potential. It is defined as the difference between potential yield and actual yield observed at the plot, farm or regional level. Despite its abundant use, the yield gap can be defined and measured in a number of ways, which has resulted in a lack of consistency in yield gap analysis in the literature [@Lobell2009]. Furthermore, in a recent review on the use of yield gap analysis in key policy papers @Sumberg2012 noted that _"there is a tension between the notion of yield gap as developed in crop ecology (although even here there is no single or consistent usage) and micro-economic studies"_ [p. 510]. This paper aims to contribute to this discussion by integrating agronomic and economic approaches to yield and yield gap assessment using maize in Nigeria as a case-study. 

A 'tension' that this paper aims to address is the measurement and use of _economic yield_ when estimating yield gaps. @Fischer2015 defines economic yield as _"as the yield attained by farmers with average natural resources when economically optimal practices and levels of inputs have been adopted while facing all the vagaries of weather"_ (p. 11). @VanIttersum2013 refer to this yield level as _exploitable yield_. In the agronomic literature it is commonly defined as 70%-85% of (water-limited) potential yield. This value is used as a 'rule of thumb' to capture the empirical finding that yield levels tend to stagnate at around 70-85 percent of potential yield [@Cassman1999; @Cassman2003; @Lobell2009]. Economic behaviour mainly explains this phenomenon. For most farmers it will not be cost-effective to purchase the large amount of inputs (e.g. fertilizer) that are needed to produce at the potential yield level [@Fischer2014] nor will farmers be willing to pay for the additional costs that are needed to 'fine-tune' crop and soil management [@Cassman2003]. As pointed out by @Fischer2015, these numbers are based on "general experience" [p.11] and mainly represent situations _"where there is no other competition for the farmers’ resources, and world prices and reasonable transport costs operate"_ [p.11]. He also points out that in situations where this does not occur, such as Sub-Saharan Africa, which are characterized by poor infrastructure and weak institutions, economic yield is expected to be much lower. 

The concept of economic yield does not exist as such in the (agronomic) economic literature. However, there is an extensive and long-standing literature on economic optimal fertilizer use. The standard approach in this literature is to estimate a yield response curve and calculate the economic optimal input and output levels under the mainstream economic assumption that farmers maximize profit [@Jauregui1992]. This approach has been used to assess both input levels on experimental plots [e.g. @Scaife1968] and farmers' plots, using household survey data [See @Jayne2013 for an overview]. 

An 'inconsistency', this paper tries to clarify is the use and meaning of 'attainable yield, which is frequently used in the yield gap literature as an alternative benchmark to calculate the yield gap when (water-limited) potential yield estimations from crop models are not available.  The term is often used in in a rather ad hoc way, referring to a number of conceptually different yield targets. Various authors use it as a measure of *'the best yield achieved through skilful use of the best available technology'* [@Sadras2015, p. 6]. A similar definition is provided by @Tittonell2013, who coined the term 'locally attainable yield', defined as *the maximum yield achievable by resource endowed farmers in their most productive fields'* [p78]. Others studies use it as a measure of economic yield [@Fischer2009, @Fischer2010, @Pasuquin2014], similar to what is described above. In practice attainable yield is often estimated as the average of the (90 or 95 percentile) highest yield in the sample of observations [@Hall2013; @Mann2017]. This raises the question of what attainable yield is supposed to measure, a technical or economic benchmark, or both? And how to measure this in practice?  

We apply the agro-economic framework presented in @VanDijk2016 that combines information on potential yield from crop models, a frontier yield response curve and data on input and output prices to decompose the conventional yield gap into four components: technical efficiency, economic, feasible and technology yield gap. We believe these four components are able to shed light on the relative importance of economic and technological components of the conventional yield gap and, as such, can contribute  to clarifying some of the inconsistencies described above.  

The structure of the paper is as follows. Section 2 provides a conceptual framework that integrates the various definitions of yield levels and yield gap. Section 3 briefly discusses the Nigerian farm level maize data set that is used to illustrate the conceptual model. Section 4 computes the yield levels and yield gaps followed by a discussion in Section 5. Finally, Section 6 concludes. 


## Conceptual framework
Figure 1 illustrates the conceptual framework developed in @VanDijk2016. It shows the observed input and output combinations of a number of agricultural units (e.g. field, farm or region). For the purpose of illustration, we assume that the observations are small-scale farms in Africa, who produce a single output (e.g. maize) using one input (e.g fertilizer), agro-ecological conditions are identical for all farms and water is not limited. The _theoretical yield response function_ describes the relationship between yield and inputs under perfect crop management and using the most advanced technology. The maximum of the function is the potential yield level (or the water-limited potential yield in case of rain fed crops, such as maize in Nigeria). The _frontier yield response function_ is estimated using actual observations from a sample of farmers or plots in a specific country or region. It measures best-practice performance at all input levels and reflects the best management practices and technology that are available in the region. The diagonal line presents the relative input ($w$) and output ($p$) market price faced by the farmers. 

Figure 1 depicts the two yield levels that determine the conventional yield gap, actual yield ($Y_a$) for farm $F_1$ and (water-limited) potential yield ($Y_p$) as well as the associated input levels (see  @Fischer2015 for definitions of these two levels). Similar to @Tittonell2013, we argue that the yield gap is caused by two main factors: (1) resource use intensity and (2) access to and use of  technology. The relationship between resource use and yield is given by the yield response curve. Intensification will results in higher yields, represented by a movement over the curve to the right. We argue that for the majority of farmers the decision over how much inputs to use depends on economic considerations (i.e. profit maximization behaviour). Under the assumption of perfect functioning agricultural markets and full information, the demand for inputs will solely depend on relative market prices of inputs and output, and production technology [@Sadoulet1995]. In developing countries, the assumption of perfect markets is not realistic because of high transaction costs, missing credit and insurance markets and lack of information on input and output prices and available technologies [@Stiglitz1989; @Dillon2014]. Under these circumstances, the demand for inputs tends to be lower than the economic optimum resulting in lower output and yield [@Kelly2003]. It is also possible that farmers' behaviour is guided by other than economic objectives such as environmental awareness or output targets, which results in sub-optimal economic input use.  

The second major cause of yield gaps is related to the efficient use and adoption of technology. Two different aspects are relevant. The first is technical efficiency, which is defined as the farm’s ability to produce maximum output given a set of inputs and technology [@Farrell1957a; @Coelli2005]. Best-practice farmers, who are located on the yield response frontier, are considered technically efficient. Farmers below the frontier are considered inefficient because they have a lower yield despite using the same level of inputs and experience the same agro-ecological conditions. Technical inefficiency implies that crop management is sub optimal, referring to differences in planting dates, spacing, weeding and form of the inputs applied, which, in turn can be related differences in experience and practices, and access to extension services [see @Bravo-Ureta2007; @Ogundari2014 for reviews].

The second technology aspect is the adoption of advanced technologies. As has been pointed out by @Tittonell2013 most small-scale farmers are subsistence farmers with limited access to appropriate technologies. Even if resource availability was not be a problem and farmers were produce at best-practice level, there would still be a gap with the potential yield level. Closing this gap would require the use of advanced technologies such as precision agriculture, advanced crop management and the adoption of the latest varieties (hybrid seeds). The adoption of advanced technologies will help farmers to increase their yield to a level that previously could not be attained. The effect is an upward shift of the frontier yield response curve in the direction of the theoretical yield response curve and a reduction of the yield gap.

Three yield levels can be derived on the basis of the economic, technical efficiency and technology constraints discussed above: 

- _Technical efficiency yield_ measures best-practice performance for a field, farm or region at each input level and reflects the available technology and best management practices in the sample.

- _Economic yield._ is defined as the yield level at which profits are maximized. At this level, the marginal cost of acquiring an additional unit of input (e.g. fertilizer) is equal to the marginal revenue of producing an additional unit of output (e.g. tons of maize). It describes a situation of allocative efficiency where inputs and outputs are distributed in an economically optimal way. This definition of economic yield is consistent with mainstream economic theory, which postulates that economic actors (e.g. farmers) maximize profits (not production), subject to given output prices, input costs and production technology [@Sadoulet1995]. Economic yield is identified by the point where the relative market price line ($w/p$) is tangent to the frontier yield response function. 

- _Feasible yield._ Feasible yield represents the maximum feasible yield that can be reached on a plot with the available technology and best-practice management, but without any economic constraints (e.g. inputs are free). It is identical to the  meaning of attainable yield as used by @Sadras2015 and @Tittonell2013 but we prefer to use a different name in order to avoid confusion. [@I think you should explain the confusion you are avoiding]

The figure also depicts the _highest farmers' yield_, which is defined as the average of the top 90 or 95 percentile actual yield observed in a sample of farmers or plots [@Laborte2012; @Silva2016] but displayed as a single observation here for convenience. Like in Figure 1, in practice, it is expected that the highest farmers' yield lies between the economic and feasible yield level. In case of non-economic behaviour or when a subgroup of farmers experience relative price levels that differ from market prices (e.g. in the case of input subsidies that are common practice in many sub-Saharan African countries), the highest farmers yield will be higher than economic yield. In theory, it is also possible that the highest farmers' yield is lower than the economic yield level. This is however, unlikely as this would point in the direction of serious market distortions as none of the farmers produces at the economic optimum level.  


**Figure 1: Conceptual framework**

```{r Figure-1}
knitr::include_graphics("../FigTabMap/Figure-1.png")
#knitr::include_graphics(file.path(root, "FigTabMap/Yield_Gap_Framework.png")) Does not work for some reason..
```

##### Source: 

The total yield gap ($Yg$) can be decomposed into four parts: the technical efficiency yield gap ($TEYg$), the allocative yield gap ($AYg$), the economic yield gap ($EYg$) and the technology yield gap ($TYg$) [@VanDijk2016]. Table 1 summarizes the definitions and potential causes for the the five yield gaps that can be derived from Figure 1. 

Global studies of yield gaps clearly show that the (total) yield gap is highest in sub-Saharan countries like Nigeria [@Mueller2012; @Licker2010; @Neumann2010]. The decomposition of the yield gap provides a deeper understanding for this finding and its causes. Knowledge constraints (e.g. access to extension services) result in technical efficiency yield gaps while pervasive market failures that characterize (agricultural) input and output markets in many sub-Saharan countries will lead to economic yield gaps. Similarly, we expect a large feasible yield gap because of the unfavourable balance between input and output prices in sub-Saharan countries. This is underscored by the high fertilizer price in many sub-Saharan countries caused by poor dealer networks, high transportation costs and small market size [@Morris2007]. Finally, the technology yield gap is also expected to be large. [ADD evidence technology use in Africa]. The existence of (agricultural) technology gaps between rich and poor countries has been studied widely [@Fagerberg1994, @Mekonnen2015, @Headey2010a] and can been related to the combination of broader institutional, technological, economic and social factors.

###### PAGE BREAK

**Table 1: Yield gaps**

```{r Table 1}
library(readr)
library(knitr)
Tab_YG <- read_csv(file.path(root, "FigTabMap/Table-1.csv"))
kable(Tab_YG)
```

##### Source: 

# Data
## Potential yield
Potential water-limited yield is taken from the global yield gap atlas (GYGA, WWW.yieldgap.org). GYGA is an international project that presents consistent estimates of potential yield and yield gaps combining the best available data, robust crop simulation models and a bottom-up approach [@VanIttersum2013, @Grassini2015a] for nine major food crops in a large number of countries, including maize in Nigeria. To aggregate (simulation) results from location-specific observed data to larger spatial areas, GYGA uses a climate zonation scheme [@VanWart2013, @VanBussel2015]. Climate zones are based on a matrix of three climatic variables: (i) growing degree days (GGD, divided in 10 classes), (ii) aridity index (AI, divided into 10 classes) and (iii) temperature seasonality (3 classes) that give a total of 300 classes (of which 265 are relevant for food production). Each climate zone has an unique value that indicates the climatic characteristics. It is constructed as the sum of the three components, for example a value of 9301 refers to a GGD of 9000, an AI of 300 and a temperature seasonality of 1. Figure 2 depicts the climate zones and associated potential water-limited yield for Nigeria. 

**Figure 2: Yield gap and LSMS**

```{r Figure-2}
Fig_GYGA_LSMS
```

##### Source: Potential water-limited yield from GYGA and actual yield by enumeration area from the World Bank LSMS-ISA surveys.
##### Note: Coloured areas refer to the seven climate zones for which >=50 observations from the LSMS-ISA are available. Grey areas indicate climate zones for GYGA presents information but for which not enough LSMS-ISA observations are available. White areas are not covered by GYGA. Actual yield is based on the pooled sample and weighted by plot size. 


# Farm and plot level data
The plot and farm level data come from the nationally representative 2010-11 and 2012-13 waves of the  Nigeria General Household Survey (GHS). In total the GHS is a cross section of 22,000 households, 5,000 of which were included as panel households as part of the Living Standards measurement Study Integrated Surveys in Agriculture (LSMS-ISA) initiative.  The focus of the LSMS-ISA is to improve the quality of data on the agricultural sector and was conducted by the National Bureau of Statistics in partnership with the Federal Ministry of Agriculture and Rural Development, the National Food Reserve Agency, the Bill and Melinda Gates Foundation and the World Bank. In each wave, households were visited twice reflecting the post planting and post harvest visits. The data was collected at several levels, including at the plot, household and enumeration area level, and the location of each household was GPS recorded with an offset to preserve household anonymity.

### Basic information
The agricultural questionnaire of the LSMS-ISA records key information at the plot level including the quantity of crop harvested, type and quantity of fertilizer applied, seed use and the area of the plot. Plot area measurements were recorded by GPS in each wave, and where it was not possible to record the GPS area, for example due to cloudy weather, the World Bank provides a complete set of plot areas with imputed missing values [@Palacios-Lopez2014]. From this information, maize yield and nitrogen and seed application rates can be calculated. The LSMS-ISA also provides information on harvested crop area, which can be used as an alternative to plot area for the estimation of maize yield. Finally, the LSMS-ISA presents information on economic production factors, including farm assets, use of animal traction and labor.  

Exploratory data analysis showed that several variables clearly fell outside a plausible range. We followed the approach of previous studies that use similar plot and farm level surveys [e.g. @Sheahan2013] and winsored outliers that were more than three standard deviations [@Absolute deviations?] from the median. Winsoring involves replacing extreme values with the value at a pre-defined threshold (in this case three standard deviations) instead of dropping the observation completely. To deal with outliers in nitrogen application rates, we follow @Liverpool-Tasie2016a and cap the use of nitrogen to 700 kg per hectare, the upper-limit of inorganic fertilizer use in the United States under irrigated conditions. We also decided to remove plots that have an area of less than 0.05 ha for which GPS measurements are less accurate and more than 10 ha, which we do not consider small scale farmers. Finally, we remove a small number of plots that have a maize yield of more than 15.9 tons per ha, the highest potential yield in Nigeria according to GYGA.

To estimate the frontier yield response function we used all available data on maize production in Nigeria provided by the LSMS-ISA (@observations  in total). Of these observations, @XX [@X] are located in GYGA climate zones (Figure X). In order to have sufficient observations, we focus the analysis on seven climate zones for which >=50 observations are available (@X% of the observations in climate zones). Although our final sample is not representative for total maize production in Nigeria, it represents the main maize regions in the country. Table 2 presents key statistics per climate zone. Summary statistics for all variables are presented in the appendix. The table demonstrates the diversity in farming systems across climate zones in Nigeria. Zones 9301 and 9901 are characterised by relatively high fertilizer application rates and yield, while zones 9701 and 9801 show relatively low levels of intensification and yield. The observed yield gaps are smaller than those in the GYGA, which was also found by @VanDijk2016 for Tanzania. Possible explanations for this include differences in samples (i.e. strong focus on smallholders in the LSMS-ISA), [@ADD]. Also note that we present area-weighted averages, which are up to [@add] percent smaller than unweighted averages because of the inverse relationship between farm size and yield [@Carletto2013a] that is also observed for Nigeria. Yield gaps using the unweighed average are very close to the gap in the GYGA.  


**Table 2: Descriptive statistics per climate zone**

```{r Table-2}
pander(Tab_CZ)
```

##### Source: LSMS-ISA and GYGA
##### Note: *Conditional on use of nitrogen. All Yield and yield gap values are weigthed values using plot or harvested area as weights. Nitrogen values use plot area as weights. 


### Plot versus harvested area
In yield gap analysis it is common practice to apply the FAO definition for actual yield, which  expresses yield relative to harvested land area [@Fischer2015]. In a recent study @Reynolds2015 argue that this definition leads to serious overestimation of actual yield because it ignores crop losses that might occur between planting and harvesting. Hence, they recommend to use a definition of yield relative to area planted. Causes for the difference in area planted and area harvested include crop management factors (e.g. poor germination, damage from pests and diseases) and economic constraints (e.g. labour and capital constraints and shortage of market opportunities). These are precisely the issues that one aims to capture with yield gap analysis. It is likely that crop management and resource use decisions of farmers are based on the total planted area not the harvested area because resources are needed during the growing season for pest management. Assessments using a definition based on harvested area therefore probably underestimate the yield gap. 

In practice, data on area planted is not available in plot and household surveys, such as the LSMS-ISA. Instead, it provides information on total (GPS-measured) plot area. A definition based on plot area, will probably overestimate the gap, in particular when more than one crop is grown on a plot (e.g. inter-cropping or presence of fruit trees). Multi-cropping is an important issue in our sample as on @X of the plots more than one crop is grown. 

The LSMS-ISA for Nigeria provides information on both plot area and harvested area, which makes it possible to investigate the impact of both area definitions on yield gap measurement. Unfortunately harvested crop area is only available as a farmer self-reported estimate, while plot area is available as self-reported and gps measure. The latter is highly preferred as self-reported values are characterized by systematic errors [@Carletto2015a]. Although it is likely that self-reported harvested and plot area are biased, we assume that their relative value is less prone to error. It is probably easier for farmers to assess the share of harvested area in total plot area than estimate absolute figures on size, which would require an extremely well trained eye. Hence, we estimate the harvested area as follows:    

$$ Harvested\:area= Plot\:area\:(gps) * \frac {Harvested\:area\: (farmer-assessed)}{Plot\:area\:(farmer-assessed)} $$

### Input and output price information
A key objective of this study is to investigate the economic constraints to closing the yield gap. For this we need information on maize and fertilizer prices. The LSMS-ISA presents plot-level information on both the value and quantity of maize sold  and fertilizer purchased. We used this to calculate plot level prices. Following @Sheahan2013 we applied the chemical composition of fertilizer (most common are @add) to estimate the price of Nitrogen. To remove the effect of outliers, we winsored all data [@I think you should be more specific which variables. Otherwise it sounds like we winsor every variable in the data] at 1.5 times the median value. In case plot-level data was missing we used the regional, zonal or national average price level as a substitute.

Figure 3 shows the distribution of maize and nitrogen prices per climate zone in Nigeria. Prices vary considerably within and between zones. In the Northern (9301) and central climate zones (9401, 9501 and 10401) maize prices are higher relative to those in the Southern climate zones (9701, 9801, 9901). Nitrogen prices also show spatial variation but differences between climate zones are less pronounced. The wide range of prices illustrates that market conditions vary within Nigeria, which are likely to have an impact on the production decisions of the farmer and the resulting yield levels.

**Figure 3: Maize and Nitrogen prices**

```{r Figure-3}
Fig_price
```

##### Source: LSMS-ISA


## Climate and soil variables
To control for the impact of soil conditions on actual yield, we augment the LSMS-ISA data with spatial information from the Africa Soil Information Service (AfSIS, http://africasoils.net). AfSIS presents soil property maps for Africa at 250m spatial resolution and various depths based on 28 thousand sampling locations [@Hengl2015]. We use the gps coordinates of the LSMS-ISA enumeration areas to link data on soil organic carbon stock and pH for the top 200 cm soil layer from AfSIS. These indicators are frequently used as covariates in yield response function estimates [@Marenya2009b] as a measure of soil quality. Information on rainfall is directly available from the LSMS-ISA datasets.     


# Estimation of yield levels
We use stochastic frontier analysis [@Meeusen1977; @Aigner1977] to estimate the frontier yield response curve in Figure 1. This approach is somewhat comparable to boundary line analysis [@Schnug1996], which is often used to estimate yield gaps. Similar to boundary line analysis stochastic frontier analysis also estimates an envelope curve that represents best-practice yield at each level of input. It has the the advantage that it simultaneously takes into account multiple inputs instead of addressing only one input as is the case in boundary analysis. Stochastic frontier analysis is increasingly used to estimate yield gaps [@Henderson2016, @Hoang2013, @Silva2016, @Neumann2010]. 

The stochastic frontier yield response function is defined as follows: 
$$ y_i=\alpha_0 + \sum\beta C_g+\sum\eta A_i + \sum\delta E_i + \sum\theta z + v_i-u_i $$
where, $y_i$ is the logarithm of actual yield in kilograms per hectare for maize plot $i$, $C_g$ is a vector containing climatic variables defined at the spatial grid $g$ level, $A_i$ is a vector with agronomic variables, $E_i$ is a vector containing economic production factors, and $z$ is a vector representing control variables. Most variables are in logarithmic form, which means their coefficient can be interpreted as an elasticity. Following @Kennedy1981, dummy variables are transformed so that they can be interpreted as elasticities. $v_i$  is a symmetric random error and $u_i$ is non-negative random variable with a half normal distribution that measures technical efficiency (i.e. the technical efficient yield gap).

Similar to other studies that estimate yield response functions using nationally representative farmer surveys [@Burke2016, @Liverpool-Tasie2016a], we include both climatic and agronomic variables as well as economic production factors in our model. Climatic indicators include growing season rainfall data, temperature, slope and elevation. Agronomic variables include the application rate of seeds and fertilizer (measured as nitrogen) and use of agro-chemicals (pesticides and/or herbicides). As only @X percent of the plots in the sample use fertilizer, we add a dummy to control for structural differences between plots with and without fertilizer application [@Battese1997].  We control for differences in soil by using information on soil organic carbon (SOC) stock and pH from the AfSIS dataset. We follow Burke [-@Burke2012] and apply threshold values for pH of 5.5 and 7, which demarcate the optimal conditions for maize growth. Economic production factors include farm assets, use of animal traction, labour and farm size (measured by total plot area). As labour data is missing in the first wave, we follow the approach of @Liverpool-Tasie2016a and use household adult equivalency units as a proxy. Finally, we include control variables for pure maize plots (single crop as opposed to multi-crop) and survey year. Table X in the Annex presents summary statistics.

There exists a large literature on the functional form of the yield response function. Most studies that use experimental trail data have found that the find that linear response and plateau functions (i.e. Mitscherlich-Baule and Von Liebig) give the best results. This functional form assumes that plant growth is constrained by the most limiting input which is the same for all observations [@Paris1992]. This assumption  is hard to maintain when analysing farmer survey data, which is characterised by a high level of heterogeneity. For this reason, quadratic, translog and Cobb-Douglas functions are typically applied when estimating yield response functions in socio-economic research settings [@Sherlund2002, @Sheahan2013]. The use of these more flexible functions is confirmed by Berck and Helfand [@Berck1990], who demonstrate that under heterogeneous conditions the results from  linear response and plateau models converge to those of Cobb-Douglas and quadratic functions. To keep things tractable, we use the relatively simple Cobb-Douglas function in this study. 

To estimate economic yield we use the plot-level price information depicted in Figure 3 and calculated the economic optimum yield level, i.e. the level at which farmers maximize profits. As we only have price information on one input (nitrogen) we assume that all the other inputs remain constant when calculation optimum yield and nitrogen levels. This assumption is realistic in the short-run when assets and land are fixed but is less realistic in the longer-run when farmers have an incentive to purchase more land and equipment to maximize profits. The same approach is also used in the literature on optimum fertilizer use [@Sheahan2013, @Burke2016]. 

We collected additional information on the amount of nitrogen ($X_f/X_p$  in Figure 1) that is required to attain potential yield in Nigeria. Information from experimental plots indicate that the maximum plot yield is achieved at around 300 kg N/ha. To reach feasible yield farmers will not only apply more fertilizer but overall move to a more intensive form of crop production, for example make more use of animal traction (only used by @x percent of the sample) and  equipment (e.g. power tillers and (small) tractors). As we do not have information on the input levels that are needed to produce feasible yield we assume that assets and labour will grow by 10%, animal traction is used uniformly and agro-chemicals are applied to all maize plots. We take Water-limited potential yield from the GYGA (Figure 2). 

Finally, we performed a consistency check on our estimations by comparing them with potential yield (also presented in the GYGA) for each climate zone. Potential yield can be considered as the absolute bio-physical maximum production level and therefore should always be higher than the estimated yield levels. For @X plots, some of the estimations (mainly the feasible yield level) was too high, meaning our model overestimates yield. In such cases we winsored the estimations to the potential yield level.


# Results
## Frontier yield response estimation
Table 3 presents the stochastic frontier estimations for the two definitions of yield, relative to harvested area and relative to plot area (hereafter referred to as ha yield and pa yield). The coefficients and significance are very similar for both models. From the climatic variables only rainfall is significant and exhibits a non-linear relationship with yield. From the agronomic variables, nitrogen and seed application are highly significant with elasticities of 0.11-0.13 and  0.06-0.08. There is no structural difference between plots with and without fertilizer application and use of agro-chemicals has no significant impact on maize yield. From the economic factors, labour input and animal traction (only in the harvested area model) are significant. Plots on which only one crop is grown have a higher yield than multi-crop plots. [@check which crops are also planted alongside maize]. The model also indicates that on average maize yield was relatively higher in the 2012/13 [@ season/rainy season?], which may be attributed to a variety of reasons such as annual weather or economic shocks. [@compare with TZA results].

A likelihood ratio, which compares the stochastic frontier model with a corresponding OLS model indicates the models are significantly different, which means there is significant technical inefficiency. This is confirmed by a high $\gamma$ value in the model output, which indicates the importance of the inefficiency term $u$. A $\gamma$ of zero would indicate no inefficiency and an OLS model would be more appropriate. 

**Table 3: Frontier yield response curve estimation**

````{r Table-3}
pander(Tbl_sfa)
```

##### Note: coefficients for dummy variables have been transformed following @Kennedy1981 to measure impact in percentages; * Significant at 10% level; ** Significant at 5% level; *** Significant at 1% level.

Figure 4 compares actual yield and the three estimated yield levels between models. By definition, actual ha yield is identical (in case of single crop plots) or higher than actual pa yield. The figure shows a number of extreme values, where ha yield is much higher than pa yield. This might be caused by exceptional cases where the harvested area is relatively very small vis-a-vis plot area or by the bias in the measurement of harvested area because of farmer self-assessment. These outliers will have only limited effect on the estimation of the yield levels because the stochastic frontier approach controls for random errors in the dependent variable. As expected, the majority of all three yield levels are higher for ha yield model. Differences in the coefficients between the two models result in the opposite effect for a small number of observations. 


**Figure 4: Comparison of yield levels across models**

```{r Figure-4,  fig.width=7, fig.height=7}
Fig_gps_harv_comp
```

##### Source: 

Figure 5 presents the same data as in Figure 4 separately plus additional information on highest farmers yield and potential yield separately for each climate zone. It is therefore a full operationalisation of our conceptual framework (Figure 1). The bars indicate average values, while the whiskers show the 5-95% percentile range. Highest farmer yield is calculated as the 95th percentile. Information is presented separately for ha and pa yield. The following can be observed from the figure. 

First, as has been discussed in the previous section, ha yield levels tend to be equal or higher than pa yield. Differences between the two measures can be substantial. The difference is particularly large in climate zone 9901, for which the data shows that harvested area is much smaller than plot area (Table 1). The difference might be the result of events that are particular to this zone, including agronomic (e.g. pests, diseases and drought) and socio-economic causes (e.g. lack of fertilizers or seeds in the region) that result in crop failure and, hence, relatively small harvested area. Alternatively, it might be a bias in the data. More research is needed to explain this finding. 

Second, the whiskers show that actual yield varies considerably within and between climate zones. Consequently, the other yield levels, which are derived estimates, also exhibit a wide distribution. As potential yield is the same for all farmers, strong variation in actual yield within a climate zone is most likely being caused by differences in socio-economic conditions (e.g. infrastructure, prices and access to extension services, credit and insurance) that lead to different levels of intensification (Table 1). 

Third, the pattern of highest farmers yield in comparison to other yield levels differs markedly between climate zones. For a number of climate zones (9401, 9701, 9801) it is close to economic yield, while for other climate zones (9301, 9501, 9901) it is close to feasible yield. This illustrates the different underlying behaviour by farmers with the highest yield in the sample. The first group of farmers with highest yield is in line with economic behaviour. The second group of farmers achieve higher yield levels that the economic optimum for all farmers in the climate zone. 

[@check, Nitrogen and prices!!!@DO THESE FARMERS FACE DIFFERENT PRICES OR IS SOMETHING ELSE GOING ON CHECK] 

Possible explanations for this behaviour include local market distortions (input and output subsidies), other incentives (awards related to performance) or intrinsic motivation by the farmer. Climate zone 10401 stands out, as highest farmers yield is larger than the feasible yield level. This is only possible if these farmers (plots) are located above the frontier in Figure 1. This means that the yield is so high in  comparison to other observations that it becomes part of the error term in our stochastic frontier model. [@have a close look at data].   

Finally, there is considerable variation in relative yield levels between climate zones. For example in climate zone 9701, differences in technical efficiency, economic and feasible yield contribute equally to differences between potential and actual yield, while in climate zone 9401, these three yield levels are relatively small in comparison to potential yield. 


## Yield levels
[@CHECK ABBREVIATIONS should be harmonised with conceptual model]
**Figure 5: Yield levels per climate zone and model**

```{r Figure-5, fig.width=8, fig.height=8}
Fig_YL2
```

##### Source: 


Figure 6 illustrates the decomposition of the total yield gap into its four components for both definitions of area. With the exception of climate zone 9701 and 9901, the distribution of yield gaps is broadly the same across climate zones and between yield levels based on harvested area and plot area. The technology yield gap explains the largest share (50%-56% on average). This is followed by the technical efficiency yield gap (19%-25% on average) and the feasible yield gap (16%-21%), which have similar shares. Finally, the economic yield gap (4%-8% on average) is the smallest contributor to the total yield gap. The results indicate that technological constraints (e.g. precision farming, advanced crop management) are the main cause of the maize yield gap in Nigeria, while market failures are relatively less important. The latter result is also found by @Liverpool-Tasie2016a, who used the same dataset to analyse optimal fertilizer use. The similarity in yield gap shares across the country, suggests that national-level factors are relatively more important that local factors in explaining the yield gap. 

As discussed above, climate zone 9701 is characterised by high actual ha yield levels, which results in a large technical efficiency gap of 43% that 'squeezes' the technology gap, which is calculated as a residual. The decomposition using pa yield levels is similar to other climate zones. The results for climate zone 9701 are different irrespective of the definition used for area. The main difference is the technical efficiency yield gap component, which is twice as large as in other climate zones. The economic and feasible yield gaps are comparable to the other climate zones, while the residual technology yield gap is naturally smaller. 



**Figure 6: **

```{r Figure-6}
Fig_YG
```

##### Note: 

# Discussion 
## Measurement of attainable yield and use of highest farmers' yield
Attainable yield is interchangeably used in the yield gap literature as an indicator of yield levels that are determined by economic factors and as a measure for some sort of technical maximum that the farmer can achieve with available technology. For this reason we refrain from using this term and introduce separate definitions for both issues: economic yield and feasible yield. Highest farmers yield is often used as a proxy for attainable yield in empirical studies that involve farm and plot level data. We found that for some climate zones, highest farmers' yield is indeed close to the feasible yield level and therefore would be a good proxy for the yield level a farmer can attain from a technical perspective. Nonetheless, for other climate zones, we found that higher farmers' yield is close to economic yield. In those cases highest farmers' yield would not be the appropriate measure to use as a technical benchmark in yield gap analysis. The main problem with using highest farmers' yield is that it is an an empirical indicator, not a theoretical reference point. Without any further information, it is not clear if highest farmers yield measures economic behaviour or refers to a technical ceiling level. It would be better to use crop simulation models or yield response functions, such as in this study, to determine an upper limit in yield gap assessments. In case this is not possible, researchers should be aware of the problems with using highest farmers' yield as a benchmark in yield gap assessments. 

## Measurement of economic yield
In this study we present a definition of economic yield that is grounded in mainstream economic theory and is related to the agri-economic literature on optimal input use. We prefer this definition over the use of the present definition of economic yield (also sometimes referred to as exploitable yield) that uses a uniform 'rule of thumb' to determine economic yield. Similar to the biophysical environment, economic conditions also vary spatially as illustrated by the large differences in maize and nitrogen prices between regions in Nigeria. This should be taken into account when assessing yield gaps. The present approach to estimate economic yield that assumes a single rule of thumb does not take this into account and might result in misleading yield gap estimations.   
 
Nonetheless, it is interesting to compare our findings with the conventional definition that assumes economic yield is 70-85% of potential yield. It is important to realise that the rule of thumb is based on the premise that farmers operate at the global technological frontier and yield is only constrained by economic factors. In other words the technical yield gap is reduced to zero.  Hence to make the comparison, we have to take our estimations for the feasible yield gap, because this is the part of the total yield gap that captures economic constraints to expanding yield. Strikingly, we find that feasible yield is on average between 16% and 21%, which is in line with the rule of thumb that is used to determine the conventional economic yield level. More research is needed to explore this issue further. It would, for example, be interesting to apply the framework used in this paper to a sample of farmers in countries that operate at the agricultural technological frontier where it is realistic to assume that the technology yield gap is (near) zero. 

## Measurement of actual yield 
Most attention in the literature on yield gaps has been devoted to the definition and measurement of potential yield, while that of actual yield has received relatively limited attention (e.g. in recent reviews on yield gap approaches and data requirements for yield gap analysis [@VanIttersum2013, @Grassini2015a], actual yield is not addressed at all). It is evident that the definition and measurement of actual yield has significant impact on estimations of the yield gap. In this paper we investigated the effect of using two different area measurements: harvested area, which is commonly used in yield gap studies, and plot area. Actual yield based on harvest and plot area can be considered as upper and lower bounds of 'real' actual yield. Plot size is probably the preferred measure as it approximates area planted. Yield gap estimations using actual yield relative to planted area, will also capture the part of the gap that is caused by differences in planted and harvested area, such as pest and diseases that led to crop failure as well as economic reasons that have prevented the farmer from harvesting certain parts of the plot. However, using a plot area based measure of actual yield will result in considerable bias when multiple crops are grown on the same plot. Using harvested area to compute actual yield, has the benefit that it can be compared with FAO statistics that use the same definition. 

Our analysis showed that yield gap estimates using both definitions result in similar frontier yield response functions and yield gap estimations but differences can be large when looking at specific regions or climate zones. Researchers, therefore should be clear, which definition they use in the yield gap analysis and, if data is available, conduct a sensitivity analysis to assess the impact of different area measurements on actual yield and the yield gap.  

## Limitations
The framework that is applied in this study demands detailed information on a large number of variables at low levels of aggregation covering both agronomic and economic indicators. Data quality is therefore an important issue. Although, our main database (the LSMS-ISA) is one of the most detailed and largest surveys on agricultural activities in developing countries, it still has its limitations. It only covers two years of data, while the recommended number of years to determine actual yield is five years [@Grassini2015a]. This issue might be solved in the future as it is planned to organise more LSMS-ISA survey rounds in Nigeria. Another problem is the lack of information on hybrid seeds, that will affect the yield level of farmers [@Liverpool-Tasie2016a]. Due to the nature of data collection, large-scale household surveys are commonly characterised by outliers that might affect the analysis. To address this we have cleaned the data and adopt a stochastic approach to estimate the yield levels[@ I think you should put a full stop here and delete the remainder of the sentence] but there still might be issues. Finally, we include information on bio-physical conditions, such as soil quality and rainfall in our analysis. This is very coarse information that might not represent the actual condition at the plot level. 


# Conclusions
In this paper we apply the framework of @VanDijk2016 to decompose the maize yield gap in Nigeria combining information from crop models and household survey data. The total yield gap is mainly attributed to the technology yield gap, followed by the technical efficiency, feasible and economic yield gap components. National factors are probably more important for this results than local conditions.

We used the framework to highlight several inconsistencies with frequently used yield benchmarks in the yield gap literature and propose alternatives. We find that highest farmers' yield, commonly used as a proxy for attainable yield, either measures economic yield (i.e. an economic benchmark), or feasible yield (i.e. a technical benchmark).  Hence, without any further information, one must be cautious in using highest farmers' yield as a benchmark in yield gap studies as it is not clear what it actually measures.  
We also found that the alternative measure of economic yield, which is grounded in mainstream economic theory gives similar results as the 70%-85% rule of thumb that is used as a proxy for economic yield at present. More research is needed to investigate if this similarity holds under different circumstances (e.g. advanced countries and other crops). 

Finally, we found that, to some extent, yield gap analysis and its decomposition is sensitive to the definition of actual yield, in particular if yield is defined relative to harvested or plot area. Researchers need to be clear about which definition they use when conducting yield gap assessments. 





# Appendix

ADD SUMMARY STATISTICS.

# References